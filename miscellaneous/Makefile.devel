include $(TOPDIR)/rules.mk

PKG_NAME:=letmecreate
PKG_VERSION:=0.1

PKG_LICENSE:=BSD-3-Clause
PKG_BUILD_DIR:=$(BUILD_DIR)/$(PKG_NAME)

include $(INCLUDE_DIR)/package.mk
include $(INCLUDE_DIR)/cmake.mk

define Package/letmecreate
  SECTION:=libs
  CATEGORY:=Libraries
  TITLE:=LetMeCreate
endef

CMAKE_OPTIONS = \
	-DBUILD_EXAMPLES=ON \
	-DBUILD_TESTS=ON \
	-DCMAKE_BUILD_TYPE=Debug

define Build/Prepare
	mkdir -p $(PKG_BUILD_DIR)
	$(CP) LetMeCreate/* $(PKG_BUILD_DIR)/
	rm -Rf $(PKG_BUILD_DIR)/CMakeFiles/
	rm -f $(PKG_BUILD_DIR)/CMakeCache.txt
	rm -f $(PKG_BUILD_DIR)/Makefile
	rm -f $(PKG_BUILD_DIR)/cmake_install.cmake
	rm -Rf $(PKG_BUILD_DIR)/lib/
	rm -Rf $(PKG_BUILD_DIR)/examples/CMakeFiles/
	rm -f $(PKG_BUILD_DIR)/examples/Makefile
	rm -f $(PKG_BUILD_DIR)/examples/cmake_install.cmake
	rm -Rf $(PKG_BUILD_DIR)/examples/bin
endef

define Package/letmecreate/install
	mkdir -p $(1)/usr/bin/letmecreate_examples
	$(INSTALL_BIN) $(PKG_BUILD_DIR)/examples/bin/* $(1)/usr/bin/letmecreate_examples

	mkdir -p $(1)/usr/bin/letmecreate_tests
	$(INSTALL_BIN) $(PKG_BUILD_DIR)/tests/bin/* $(1)/usr/bin/letmecreate_tests

	$(INSTALL_DIR) $(1)/usr/lib
	$(CP) $(PKG_BUILD_DIR)/lib/*.so $(1)/usr/lib/

	$(INSTALL_DIR) $(1)/usr/include/letmecreate
	$(CP) $(PKG_BUILD_DIR)/include/* $(1)/usr/include/letmecreate
endef

$(eval $(call BuildPackage,letmecreate))
